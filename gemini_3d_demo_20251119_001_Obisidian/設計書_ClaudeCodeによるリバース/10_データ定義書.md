# 10. データ定義書

> [!abstract] 概要
> 本ドキュメントは全定数、設定値、キーマップ、カラーコードを一覧化します。

---

## 物理定数

### PlayerPhysics

| 定数名 | 値 | 単位 | 説明 |
|-------|-----|------|------|
| gravity | -30.0 | m/s² | 重力加速度 |
| jumpStrength | 15.0 | m/s | ジャンプ初速 |
| speed | 10.0 | m/s | 移動速度 |
| playerRadius | 0.3 | m | 衝突判定半径 |
| playerHeight | 1.0 | m | 衝突判定高さ |
| stepHeight | 0.1 | m | 段差許容高さ |
| knockbackFriction | 0.9 | - | ノックバック減衰率 |
| upwardKnockback | 5.0 | m/s | ノックバック時上昇速度 |

### Slime衝突

| 定数名 | 値 | 単位 | 説明 |
|-------|-----|------|------|
| collisionRange | 0.8 | m | 衝突判定距離 |
| knockbackStrength | 15.0 | - | ノックバック強度 |

### Tree衝突

| 定数名 | 値 | 単位 | 説明 |
|-------|-----|------|------|
| obstacleRadius | 0.3 | m | 障害物半径 |
| playerRadius | 0.4 | m | プレイヤー判定半径 |

---

## 戦闘定数

### PlayerCombat

| 定数名 | 値 | 単位 | 説明 |
|-------|-----|------|------|
| baseSwordRotation | Math.PI / 4 | rad | 剣の基本角度（45度） |
| attackDuration | 0.4 | s | 攻撃持続時間 |
| attackRange | 2.0 | m | 攻撃判定範囲 |
| hitWindowStart | 0.2 | ratio | ヒット判定開始（進捗率） |
| hitWindowEnd | 0.6 | ratio | ヒット判定終了（進捗率） |

---

## アニメーション定数

### Slimeバウンス

| 定数名 | 値 | 単位 | 説明 |
|-------|-----|------|------|
| bounceSpeed | 3.0 | - | バウンス速度 |
| bounceHeight | 0.3 | m | バウンス高さ |
| originalY | 0.5 | m | 基準Y座標 |
| timeOffset | random() * 100 | - | 位相ずらし |
| scaleYRange | 0.7 〜 0.9 | - | Y軸スケール範囲 |
| scaleXZRange | 0.95 〜 1.05 | - | XZ軸スケール範囲 |

### Slime死亡

| 定数名 | 値 | 単位 | 説明 |
|-------|-----|------|------|
| shrinkSpeed | 2.0 | /s | 縮小速度 |
| removeThreshold | 0.01 | - | 削除判定スケール |

---

## 入力マッピング

### キーボード → アクション

| キー | アクション名 |
|------|-------------|
| W | forward |
| S | backward |
| A | rotateLeft |
| D | rotateRight |
| ArrowUp / Up | forward |
| ArrowDown / Down | backward |
| ArrowLeft / Left | rotateLeft |
| ArrowRight / Right | rotateRight |
| Space | jump |
| F | attack |
| B | toggleBuildMode |
| V | toggleView |
| K | save |
| L | load |
| M | menu |

### マウス

| 入力 | アクション |
|------|-----------|
| 左クリック | attack, placeBlock |
| 右クリック | removeBlock |

### VRコントローラー

| 入力 | インデックス | アクション |
|------|------------|-----------|
| トリガー | buttons[0] | attack |
| グリップ | buttons[1] | jump |
| スティックX | axes[2] | 左右移動 |
| スティックY | axes[3] | 前後移動 |
| デッドゾーン | 0.1 | 不感帯 |

---

## クールダウン時間

| 機能 | 時間 | 単位 |
|------|-----|------|
| クイックセーブ | 1.0 | s |
| クイックロード | 1.0 | s |
| メニュートグル | 0.5 | s |
| ブロック配置 | 0.2 | s |
| ブロック削除 | 0.2 | s |
| 建築モード切替 | 0.5 | s |

---

## サウンド定義

### playJump()

| パラメータ | 値 |
|-----------|-----|
| type | sine |
| frequency (start) | 200 Hz |
| frequency (end) | 400 Hz |
| ramp duration | 0.1 s |
| gain (start) | 0.2 |
| gain (end) | 0.01 |
| total duration | 0.2 s |

### playAttack()

| パラメータ | 値 |
|-----------|-----|
| type | triangle |
| frequency (start) | 400 Hz |
| frequency (end) | 100 Hz |
| gain (start) | 0.15 |
| gain (end) | 0.01 |
| duration | 0.15 s |

### playHit()

| パラメータ | 値 |
|-----------|-----|
| type | sawtooth |
| frequency (start) | 100 Hz |
| frequency (end) | 50 Hz |
| gain (start) | 0.2 |
| gain (end) | 0.01 |
| duration | 0.2 s |

### playEnemyDeath()

| パラメータ | 値 |
|-----------|-----|
| type | square |
| frequency (start) | 200 Hz |
| frequency (end) | 50 Hz |
| gain (start) | 0.1 |
| gain (end) | 0.01 |
| duration | 0.1 s |

---

## カラーコード

### シーン

| 用途 | 色コード | 色名 |
|------|---------|------|
| 背景 | 0x87CEEB | スカイブルー |
| 地面 | 0x999999 | グレー |

### ライティング

| 光源 | 色コード | 強度 |
|------|---------|------|
| AmbientLight | 0x404040 | 2 |
| DirectionalLight | 0xFFFFFF | 2 |

### ブロック

| タイプ | 色コード | 色名 |
|-------|---------|------|
| stone | #808080 | グレー |
| stone_dark | #555555 | ダークグレー |
| wood | #A0522D | シエナ |
| leaves | #228B22 | フォレストグリーン |
| dirt (default) | #8B4513 | サドルブラウン |

### プレイヤー

| パーツ | 色コード | 説明 |
|-------|---------|------|
| whiteFelt | #FFFFFF | 毛皮（白） |
| pinkFelt | #FFB6C1 | 耳内側（ピンク） |
| blueFelt | #0000FF | ケープ（青） |
| metal | #888888 | 鎧（銀） |
| darkMetal | #333333 | リベット（暗銀） |
| leather | #8B4513 | 革（茶） |
| black | #111111 | 口 |
| plasticBlack | #000000 | 目 |

### スライム

| パーツ | 色コード | 説明 |
|-------|---------|------|
| body | #32CD32 | ライムグリーン |
| eyes | #000000 | 黒 |
| highlight | #FFFFFF | 白 |

### 木

| パーツ | 色コード |
|-------|---------|
| trunk | 0x8B4513 |
| leaves | 0x228B22 |

### 岩

| パーツ | 色コード |
|-------|---------|
| body | #808080 |

### UI

| 用途 | 色コード |
|------|---------|
| Save New ボタン | #27ae60 |
| Overwrite ボタン | #f39c12 |
| Load ボタン | #2980b9 |
| Delete ボタン | #c0392b |
| Close ボタン | #555555 |
| エラー文字 | #ff6b6b |
| 建築プレビュー | 0x00FF00 |

---

## ジオメトリサイズ

### プレイヤー

| パーツ | ジオメトリ | パラメータ |
|-------|-----------|-----------|
| body | SphereGeometry | radius: 0.4 |
| leg | CapsuleGeometry | radius: 0.1, length: 0.5 |
| boot | CapsuleGeometry | radius: 0.12, length: 0.15 |
| foot | SphereGeometry | radius: 0.12, scale: (1, 0.6, 1.5) |
| head | SphereGeometry | radius: 0.35 |
| ear | CapsuleGeometry | radius: 0.08, length: 0.45 |
| innerEar | CapsuleGeometry | radius: 0.05, length: 0.35 |
| eye | SphereGeometry | radius: 0.05 |
| highlight | SphereGeometry | radius: 0.015 |
| nose | SphereGeometry | radius: 0.02 |
| mouth | CylinderGeometry | radius: 0.005, height: 0.05 |
| helmet | SphereGeometry | radius: 0.36, half-sphere |
| helmetRim | TorusGeometry | radius: 0.36, tube: 0.03 |
| bolt | SphereGeometry | radius: 0.01 |
| armor | CylinderGeometry | radius: 0.41, height: 0.3 |
| collar | TorusGeometry | radius: 0.41, tube: 0.03 |
| shoulder | SphereGeometry | radius: 0.16, 75% sphere |
| belt | CylinderGeometry | radius: 0.42, height: 0.08 |
| buckle | BoxGeometry | 0.1 × 0.1 × 0.05 |
| cape | PlaneGeometry | 0.6 × 0.8 |
| swordHandle | CylinderGeometry | radius: 0.02, height: 0.2 |
| swordGuard | BoxGeometry | 0.2 × 0.02 × 0.05 |
| swordBlade | BoxGeometry | 0.06 × 0.6 × 0.02 |
| shield | CylinderGeometry | radius: 0.3, height: 0.05 |

### スライム

| パーツ | ジオメトリ | パラメータ |
|-------|-----------|-----------|
| body | SphereGeometry | radius: 0.4, scale: (1, 0.8, 1) |
| eye | SphereGeometry | radius: 0.08 |
| highlight | SphereGeometry | radius: 0.02 |

### ブロック

| パーツ | ジオメトリ | パラメータ |
|-------|-----------|-----------|
| block | BoxGeometry | 1 × 1 × 1 |

### 木

| パーツ | ジオメトリ | パラメータ |
|-------|-----------|-----------|
| trunk | CylinderGeometry | top: 0.2, bottom: 0.3, height: 2 |
| leaves | ConeGeometry | radius: 1.5, height: 3 |

### 岩

| パーツ | ジオメトリ | パラメータ |
|-------|-----------|-----------|
| rock | DodecahedronGeometry | radius: 0.5 × scale |

### 地面

| パーツ | ジオメトリ | パラメータ |
|-------|-----------|-----------|
| ground | PlaneGeometry | 100 × 100 |

---

## カメラ設定

| パラメータ | 値 |
|-----------|-----|
| FOV | 75 |
| near | 0.1 |
| far | 1000 |
| 初期位置 | (0, 1.6, 3) |
| TPS オフセット | (0, 2, 5) |
| FPS オフセット | (0, 0, 0) |

---

## 初期城パラメータ

| パラメータ | 値 |
|-----------|-----|
| castleX | -10 |
| castleZ | -10 |
| size | 8 |
| height | 6 |
| blockType | stone_dark |
| 窓条件 | y > 2 && (x + z) % 3 === 0 |

---

## ワールド生成パラメータ

### WorldManager.populate()

| エンティティ | 数 | 配置範囲 |
|-------------|-----|---------|
| Tree | 20 | random(-50, 50) × random(-50, 50) |
| Rock | 30 | random(-50, 50) × random(-50, 50) |
| Slime | 5 | random(-20, 20) × random(-20, 20) |

---

## LocalStorageキー

| 用途 | キー |
|------|-----|
| クイックセーブ | `gemini_3d_quick_save` |
| スロットプレフィックス | `gemini_3d_save_` |
| スロットID | `{prefix}{timestamp}` |

---

## 通知表示時間

| パラメータ | 値 |
|-----------|-----|
| デフォルト表示時間 | 2000ms |
| エラー表示時間 | 4000ms |
| フェードアウト時間 | 500ms |

---

## テクスチャサイズ

| 用途 | サイズ | ノイズ数 |
|------|--------|---------|
| PlayerMesh | 512×512 | 50,000 × 2 |
| Block | 256×256 | 5,000 × 2 |
| Slime | 256×256 | 10,000 × 2 |
| Rock | 256×256 | 10,000 × 2 |

---

## マテリアル設定

### フェルトマテリアル共通

| プロパティ | 値 |
|-----------|-----|
| map | CanvasTexture |
| bumpMap | 同上 |
| bumpScale | 0.01 〜 0.05 |
| roughness | 0.9 〜 1.0 |

### メタルマテリアル

| プロパティ | 値 |
|-----------|-----|
| roughness | 0.4 |
| metalness | 0.6 |

### ダークメタルマテリアル

| プロパティ | 値 |
|-----------|-----|
| roughness | 0.5 |
| metalness | 0.8 |

### プラスチックブラック

| プロパティ | 値 |
|-----------|-----|
| roughness | 0.1 |
| metalness | 0.1 |

---

## Z-Index階層

| 要素 | z-index |
|------|---------|
| エラーコンテナ | 9999 |
| SaveLoadUI | 1000 |

---

## Three.js バージョン

| パッケージ | バージョン |
|-----------|-----------|
| three | ^0.160.0 |
| vite | ^5.0.0 |

---

## 関連ドキュメント

- [[09_UI設計|前: UI設計]]
- [[_MOC_設計書|設計書目次]]

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-11-23 | 初版作成 |
