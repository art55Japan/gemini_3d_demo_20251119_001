英名: Lifecycle.md

# Lifecycle (Startup)

ゲーム開始時の処理順序をまとめます。

1. Three.js初期化: `Scene` 作成、背景色設定、`PerspectiveCamera` 配置(0,1.6,3)、`WebGLRenderer` をXR有効で生成。
2. DOM/UI: VRButtonを追加。クリックスタートのオーバーレイと通知用DOMを生成。
3. 照明/地面: AmbientLight, DirectionalLight, Plane(100x100) を配置。
4. 入力: `Input` を生成し、キー/マウス/VR入力のリスナーを登録。
5. 管理クラス: `EntityManager`、`AudioManager`、`CameraManager` を生成。
6. プレイヤー: `Player` を生成・シーンへ追加。`PlayerPhysics/Combat/Collision` を内部保持。
7. 環境生成: `WorldManager.populate` で Tree/Rock/Slime を配置し、Rockを `collidables` へ追加。
8. ビルド: `BuildSystem` を生成し Player をセット。ゴーストブロックをシーンに追加（初期は非表示）。
9. セーブ系: `SaveManager` と `SaveLoadUI` を生成。タイムスタンプ管理用の変数を初期化。
10. 初期構造物: `createInitialCastle` で城ブロックを生成し、`EntityManager` と `collidables` に登録。
11. ループ開始: `renderer.setAnimationLoop(Game.render)` でフレーム更新開始。

